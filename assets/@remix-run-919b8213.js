/**
 * @remix-run/router v1.6.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A.apply(this,arguments)}var N;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(N||(N={}));const et="popstate";function Ar(e){e===void 0&&(e={});function t(a,s){let{pathname:d="/",search:u="",hash:f=""}=Z(a.location.hash.substr(1));return we("",{pathname:d,search:u,hash:f},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(a,s){let d=a.document.querySelector("base"),u="";if(d&&d.getAttribute("href")){let f=a.location.href,m=f.indexOf("#");u=m===-1?f:f.slice(0,m)}return u+"#"+(typeof s=="string"?s:Re(s))}function n(a,s){ne(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return jt(t,r,n,e)}function F(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ne(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Nt(){return Math.random().toString(36).substr(2,8)}function tt(e,t){return{usr:e.state,key:e.key,idx:t}}function we(e,t,r,n){return r===void 0&&(r=null),A({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Z(t):t,{state:r,key:t&&t.key||n||Nt()})}function Re(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Z(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function jt(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,d=a.history,u=N.Pop,f=null,m=h();m==null&&(m=0,d.replaceState(A({},d.state,{idx:m}),""));function h(){return(d.state||{idx:null}).idx}function y(){u=N.Pop;let w=h(),o=w==null?null:w-m;m=w,f&&f({action:u,location:U.location,delta:o})}function E(w,o){u=N.Push;let P=we(U.location,w,o);r&&r(P,w),m=h()+1;let L=tt(P,m),D=U.createHref(P);try{d.pushState(L,"",D)}catch{a.location.assign(D)}s&&f&&f({action:u,location:U.location,delta:1})}function I(w,o){u=N.Replace;let P=we(U.location,w,o);r&&r(P,w),m=h();let L=tt(P,m),D=U.createHref(P);d.replaceState(L,"",D),s&&f&&f({action:u,location:U.location,delta:0})}function C(w){let o=a.location.origin!=="null"?a.location.origin:a.location.href,P=typeof w=="string"?w:Re(w);return F(o,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,o)}let U={get action(){return u},get location(){return e(a,d)},listen(w){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(et,y),f=w,()=>{a.removeEventListener(et,y),f=null}},createHref(w){return t(a,w)},createURL:C,encodeLocation(w){let o=C(w);return{pathname:o.pathname,search:o.search,hash:o.hash}},push:E,replace:I,go(w){return d.go(w)}};return U}var O;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(O||(O={}));const Ht=new Set(["lazy","caseSensitive","path","id","index","children"]);function Wt(e){return e.index===!0}function pt(e,t,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),e.map((a,s)=>{let d=[...r,s],u=typeof a.id=="string"?a.id:d.join("-");if(F(a.index!==!0||!a.children,"Cannot specify children on an index route"),F(!n[u],'Found a route id collision on id "'+u+`".  Route id's must be globally unique within Data Router usages`),Wt(a)){let f=A({},a,t(a),{id:u});return n[u]=f,f}else{let f=A({},a,t(a),{id:u,children:void 0});return n[u]=f,a.children&&(f.children=pt(a.children,t,d,n)),f}})}function ye(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?Z(t):t,a=Pe(n.pathname||"/",r);if(a==null)return null;let s=mt(e);$t(s);let d=null;for(let u=0;d==null&&u<s.length;++u)d=Zt(s[u],rr(a));return d}function mt(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,d,u)=>{let f={relativePath:u===void 0?s.path||"":u,caseSensitive:s.caseSensitive===!0,childrenIndex:d,route:s};f.relativePath.startsWith("/")&&(F(f.relativePath.startsWith(n),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(n.length));let m=ve([n,f.relativePath]),h=r.concat(f);s.children&&s.children.length>0&&(F(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),mt(s.children,t,h,m)),!(s.path==null&&!s.index)&&t.push({path:m,score:Xt(m,s.index),routesMeta:h})};return e.forEach((s,d)=>{var u;if(s.path===""||!((u=s.path)!=null&&u.includes("?")))a(s,d);else for(let f of gt(s.path))a(s,d,f)}),t}function gt(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let d=gt(n.join("/")),u=[];return u.push(...d.map(f=>f===""?s:[s,f].join("/"))),a&&u.push(...d),u.map(f=>e.startsWith("/")&&f===""?"/":f)}function $t(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Qt(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Kt=/^:\w+$/,Vt=3,Yt=2,Gt=1,qt=10,Jt=-2,rt=e=>e==="*";function Xt(e,t){let r=e.split("/"),n=r.length;return r.some(rt)&&(n+=Jt),t&&(n+=Yt),r.filter(a=>!rt(a)).reduce((a,s)=>a+(Kt.test(s)?Vt:s===""?Gt:qt),n)}function Qt(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function Zt(e,t){let{routesMeta:r}=e,n={},a="/",s=[];for(let d=0;d<r.length;++d){let u=r[d],f=d===r.length-1,m=a==="/"?t:t.slice(a.length)||"/",h=er({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},m);if(!h)return null;Object.assign(n,h.params);let y=u.route;s.push({params:n,pathname:ve([a,h.pathname]),pathnameBase:lr(ve([a,h.pathnameBase])),route:y}),h.pathnameBase!=="/"&&(a=ve([a,h.pathnameBase]))}return s}function er(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=tr(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],d=s.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((m,h,y)=>{if(h==="*"){let E=u[y]||"";d=s.slice(0,s.length-E.length).replace(/(.)\/+$/,"$1")}return m[h]=nr(u[y]||"",h),m},{}),pathname:s,pathnameBase:d,pattern:e}}function tr(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ne(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(d,u)=>(n.push(u),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function rr(e){try{return decodeURI(e)}catch(t){return ne(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function nr(e,t){try{return decodeURIComponent(e)}catch(r){return ne(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function Pe(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function ar(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Z(e):e;return{pathname:r?r.startsWith("/")?r:or(r,t):t,search:sr(n),hash:dr(a)}}function or(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Be(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function yt(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function ir(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Z(e):(a=A({},e),F(!a.pathname||!a.pathname.includes("?"),Be("?","pathname","search",a)),F(!a.pathname||!a.pathname.includes("#"),Be("#","pathname","hash",a)),F(!a.search||!a.search.includes("#"),Be("#","search","hash",a)));let s=e===""||a.pathname==="",d=s?"/":a.pathname,u;if(n||d==null)u=r;else{let y=t.length-1;if(d.startsWith("..")){let E=d.split("/");for(;E[0]==="..";)E.shift(),y-=1;a.pathname=E.join("/")}u=y>=0?t[y]:"/"}let f=ar(a,u),m=d&&d!=="/"&&d.endsWith("/"),h=(s||d===".")&&r.endsWith("/");return!f.pathname.endsWith("/")&&(m||h)&&(f.pathname+="/"),f}const ve=e=>e.join("/").replace(/\/\/+/g,"/"),lr=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),sr=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,dr=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class vt{constructor(t,r,n,a){a===void 0&&(a=!1),this.status=t,this.statusText=r||"",this.internal=a,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function cr(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const bt=["post","put","patch","delete"],ur=new Set(bt),fr=["get",...bt],hr=new Set(fr),pr=new Set([301,302,303,307,308]),mr=new Set([307,308]),Ne={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},gr={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},nt={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},wt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",yr=!Rt,vr=e=>({hasErrorBoundary:!!e.hasErrorBoundary});function Lr(e){F(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let t;if(e.mapRouteProperties)t=e.mapRouteProperties;else if(e.detectErrorBoundary){let i=e.detectErrorBoundary;t=l=>({hasErrorBoundary:i(l)})}else t=vr;let r={},n=pt(e.routes,t,void 0,r),a,s=e.basename||"/",d=A({v7_normalizeFormMethod:!1,v7_prependBasename:!1},e.future),u=null,f=new Set,m=null,h=null,y=null,E=e.hydrationData!=null,I=ye(n,e.history.location,s),C=null;if(I==null){let i=G(404,{pathname:e.history.location.pathname}),{matches:l,route:c}=ct(n);I=l,C={[c.id]:i}}let U=!I.some(i=>i.route.lazy)&&(!I.some(i=>i.route.loader)||e.hydrationData!=null),w,o={historyAction:e.history.action,location:e.history.location,matches:I,initialized:U,navigation:Ne,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||C,fetchers:new Map,blockers:new Map},P=N.Pop,L=!1,D,z=!1,j=!1,Y=[],ee=[],_=new Map,$e=0,Ae=-1,de=new Map,ce=new Set,ae=new Map,te=new Map,J=new Map,Le=!1;function Pt(){return u=e.history.listen(i=>{let{action:l,location:c,delta:p}=i;if(Le){Le=!1;return}ne(J.size===0||p!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let g=Xe({currentLocation:o.location,nextLocation:c,historyAction:l});if(g&&p!=null){Le=!0,e.history.go(p*-1),De(g,{state:"blocked",location:c,proceed(){De(g,{state:"proceeding",proceed:void 0,reset:void 0,location:c}),e.history.go(p)},reset(){he(g),H({blockers:new Map(w.state.blockers)})}});return}return X(l,c)}),o.initialized||X(N.Pop,o.location),w}function At(){u&&u(),f.clear(),D&&D.abort(),o.fetchers.forEach((i,l)=>Ue(l)),o.blockers.forEach((i,l)=>he(l))}function Lt(i){return f.add(i),()=>f.delete(i)}function H(i){o=A({},o,i),f.forEach(l=>l(o))}function ue(i,l){var c,p;let g=o.actionData!=null&&o.navigation.formMethod!=null&&q(o.navigation.formMethod)&&o.navigation.state==="loading"&&((c=i.state)==null?void 0:c._isRedirect)!==!0,R;l.actionData?Object.keys(l.actionData).length>0?R=l.actionData:R=null:g?R=o.actionData:R=null;let M=l.loaderData?dt(o.loaderData,l.loaderData,l.matches||[],l.errors):o.loaderData;for(let[v]of J)he(v);let b=L===!0||o.navigation.formMethod!=null&&q(o.navigation.formMethod)&&((p=i.state)==null?void 0:p._isRedirect)!==!0;a&&(n=a,a=void 0),H(A({},l,{actionData:R,loaderData:M,historyAction:P,location:i,initialized:!0,navigation:Ne,revalidation:"idle",restoreScrollPosition:Qe(i,l.matches||o.matches),preventScrollReset:b,blockers:new Map(o.blockers)})),z||P===N.Pop||(P===N.Push?e.history.push(i,i.state):P===N.Replace&&e.history.replace(i,i.state)),P=N.Pop,L=!1,z=!1,j=!1,Y=[],ee=[]}async function Ke(i,l){if(typeof i=="number"){e.history.go(i);return}let c=je(o.location,o.matches,s,d.v7_prependBasename,i,l==null?void 0:l.fromRouteId,l==null?void 0:l.relative),{path:p,submission:g,error:R}=at(d.v7_normalizeFormMethod,!1,c,l),M=o.location,b=we(o.location,p,l&&l.state);b=A({},b,e.history.encodeLocation(b));let v=l&&l.replace!=null?l.replace:void 0,x=N.Push;v===!0?x=N.Replace:v===!1||g!=null&&q(g.formMethod)&&g.formAction===o.location.pathname+o.location.search&&(x=N.Replace);let S=l&&"preventScrollReset"in l?l.preventScrollReset===!0:void 0,W=Xe({currentLocation:M,nextLocation:b,historyAction:x});if(W){De(W,{state:"blocked",location:b,proceed(){De(W,{state:"proceeding",proceed:void 0,reset:void 0,location:b}),Ke(i,l)},reset(){he(W),H({blockers:new Map(o.blockers)})}});return}return await X(x,b,{submission:g,pendingError:R,preventScrollReset:S,replace:l&&l.replace})}function St(){if(Se(),H({revalidation:"loading"}),o.navigation.state!=="submitting"){if(o.navigation.state==="idle"){X(o.historyAction,o.location,{startUninterruptedRevalidation:!0});return}X(P||o.historyAction,o.navigation.location,{overrideNavigation:o.navigation})}}async function X(i,l,c){D&&D.abort(),D=null,P=i,z=(c&&c.startUninterruptedRevalidation)===!0,Ot(o.location,o.matches),L=(c&&c.preventScrollReset)===!0;let p=a||n,g=c&&c.overrideNavigation,R=ye(p,l,s);if(!R){let k=G(404,{pathname:l.pathname}),{matches:B,route:K}=ct(p);Ce(),ue(l,{matches:B,loaderData:{},errors:{[K.id]:k}});return}if(Mr(o.location,l)&&!(c&&c.submission&&q(c.submission.formMethod))){ue(l,{matches:R});return}D=new AbortController;let M=ge(e.history,l,D.signal,c&&c.submission),b,v;if(c&&c.pendingError)v={[le(R).route.id]:c.pendingError};else if(c&&c.submission&&q(c.submission.formMethod)){let k=await Ft(M,l,c.submission,R,{replace:c.replace});if(k.shortCircuited)return;b=k.pendingActionData,v=k.pendingActionError,g=A({state:"loading",location:l},c.submission),M=new Request(M.url,{signal:M.signal})}let{shortCircuited:x,loaderData:S,errors:W}=await Ut(M,l,R,g,c&&c.submission,c&&c.fetcherSubmission,c&&c.replace,b,v);x||(D=null,ue(l,A({matches:R},b?{actionData:b}:{},{loaderData:S,errors:W})))}async function Ft(i,l,c,p,g){Se();let R=A({state:"submitting",location:l},c);H({navigation:R});let M,b=He(p,l);if(!b.route.action&&!b.route.lazy)M={type:O.error,error:G(405,{method:i.method,pathname:l.pathname,routeId:b.route.id})};else if(M=await me("action",i,b,p,r,t,s),i.signal.aborted)return{shortCircuited:!0};if(se(M)){let v;return g&&g.replace!=null?v=g.replace:v=M.location===o.location.pathname+o.location.search,await fe(o,M,{submission:c,replace:v}),{shortCircuited:!0}}if(be(M)){let v=le(p,b.route.id);return(g&&g.replace)!==!0&&(P=N.Push),{pendingActionData:{},pendingActionError:{[v.route.id]:M.error}}}if(re(M))throw G(400,{type:"defer-action"});return{pendingActionData:{[b.route.id]:M.data}}}async function Ut(i,l,c,p,g,R,M,b,v){let x=p;x||(x=A({state:"loading",location:l,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},g));let S=g||R?g||R:x.formMethod&&x.formAction&&x.formData&&x.formEncType?{formMethod:x.formMethod,formAction:x.formAction,formData:x.formData,formEncType:x.formEncType}:void 0,W=a||n,[k,B]=ot(e.history,o,c,S,l,j,Y,ee,ae,W,s,b,v);if(Ce(T=>!(c&&c.some(V=>V.route.id===T))||k&&k.some(V=>V.route.id===T)),k.length===0&&B.length===0){let T=qe();return ue(l,A({matches:c,loaderData:{},errors:v||null},b?{actionData:b}:{},T?{fetchers:new Map(o.fetchers)}:{})),{shortCircuited:!0}}if(!z){B.forEach(V=>{let ie=o.fetchers.get(V.key),Oe={state:"loading",data:ie&&ie.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(V.key,Oe)});let T=b||o.actionData;H(A({navigation:x},T?Object.keys(T).length===0?{actionData:null}:{actionData:T}:{},B.length>0?{fetchers:new Map(o.fetchers)}:{}))}Ae=++$e,B.forEach(T=>{T.controller&&_.set(T.key,T.controller)});let K=()=>B.forEach(T=>oe(T.key));D&&D.signal.addEventListener("abort",K);let{results:pe,loaderResults:Te,fetcherResults:Me}=await Ye(o.matches,c,k,B,i);if(i.signal.aborted)return{shortCircuited:!0};D&&D.signal.removeEventListener("abort",K),B.forEach(T=>_.delete(T.key));let Q=ut(pe);if(Q)return await fe(o,Q,{replace:M}),{shortCircuited:!0};let{loaderData:Ee,errors:Ie}=st(o,c,k,Te,v,B,Me,te);te.forEach((T,V)=>{T.subscribe(ie=>{(ie||T.done)&&te.delete(V)})});let _e=qe(),ze=Je(Ae),xe=_e||ze||B.length>0;return A({loaderData:Ee,errors:Ie},xe?{fetchers:new Map(o.fetchers)}:{})}function Ve(i){return o.fetchers.get(i)||gr}function Ct(i,l,c,p){if(yr)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");_.has(i)&&oe(i);let g=a||n,R=je(o.location,o.matches,s,d.v7_prependBasename,c,l,p==null?void 0:p.relative),M=ye(g,R,s);if(!M){Fe(i,l,G(404,{pathname:R}));return}let{path:b,submission:v}=at(d.v7_normalizeFormMethod,!0,R,p),x=He(M,b);if(L=(p&&p.preventScrollReset)===!0,v&&q(v.formMethod)){Tt(i,l,b,x,M,v);return}ae.set(i,{routeId:l,path:b}),It(i,l,b,x,M,v)}async function Tt(i,l,c,p,g,R){if(Se(),ae.delete(i),!p.route.action&&!p.route.lazy){let $=G(405,{method:R.formMethod,pathname:c,routeId:l});Fe(i,l,$);return}let M=o.fetchers.get(i),b=A({state:"submitting"},R,{data:M&&M.data," _hasFetcherDoneAnything ":!0});o.fetchers.set(i,b),H({fetchers:new Map(o.fetchers)});let v=new AbortController,x=ge(e.history,c,v.signal,R);_.set(i,v);let S=await me("action",x,p,g,r,t,s);if(x.signal.aborted){_.get(i)===v&&_.delete(i);return}if(se(S)){_.delete(i),ce.add(i);let $=A({state:"loading"},R,{data:void 0," _hasFetcherDoneAnything ":!0});return o.fetchers.set(i,$),H({fetchers:new Map(o.fetchers)}),fe(o,S,{submission:R,isFetchActionRedirect:!0})}if(be(S)){Fe(i,l,S.error);return}if(re(S))throw G(400,{type:"defer-action"});let W=o.navigation.location||o.location,k=ge(e.history,W,v.signal),B=a||n,K=o.navigation.state!=="idle"?ye(B,o.navigation.location,s):o.matches;F(K,"Didn't find any matches after fetcher action");let pe=++$e;de.set(i,pe);let Te=A({state:"loading",data:S.data},R,{" _hasFetcherDoneAnything ":!0});o.fetchers.set(i,Te);let[Me,Q]=ot(e.history,o,K,R,W,j,Y,ee,ae,B,s,{[p.route.id]:S.data},void 0);Q.filter($=>$.key!==i).forEach($=>{let ke=$.key,Ze=o.fetchers.get(ke),Bt={state:"loading",data:Ze&&Ze.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(ke,Bt),$.controller&&_.set(ke,$.controller)}),H({fetchers:new Map(o.fetchers)});let Ee=()=>Q.forEach($=>oe($.key));v.signal.addEventListener("abort",Ee);let{results:Ie,loaderResults:_e,fetcherResults:ze}=await Ye(o.matches,K,Me,Q,k);if(v.signal.aborted)return;v.signal.removeEventListener("abort",Ee),de.delete(i),_.delete(i),Q.forEach($=>_.delete($.key));let xe=ut(Ie);if(xe)return fe(o,xe);let{loaderData:T,errors:V}=st(o,o.matches,Me,_e,void 0,Q,ze,te),ie={state:"idle",data:S.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(i,ie);let Oe=Je(pe);o.navigation.state==="loading"&&pe>Ae?(F(P,"Expected pending action"),D&&D.abort(),ue(o.navigation.location,{matches:K,loaderData:T,errors:V,fetchers:new Map(o.fetchers)})):(H(A({errors:V,loaderData:dt(o.loaderData,T,K,V)},Oe?{fetchers:new Map(o.fetchers)}:{})),j=!1)}async function It(i,l,c,p,g,R){let M=o.fetchers.get(i),b=A({state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},R,{data:M&&M.data," _hasFetcherDoneAnything ":!0});o.fetchers.set(i,b),H({fetchers:new Map(o.fetchers)});let v=new AbortController,x=ge(e.history,c,v.signal);_.set(i,v);let S=await me("loader",x,p,g,r,t,s);if(re(S)&&(S=await xt(S,x.signal,!0)||S),_.get(i)===v&&_.delete(i),x.signal.aborted)return;if(se(S)){ce.add(i),await fe(o,S);return}if(be(S)){let k=le(o.matches,l);o.fetchers.delete(i),H({fetchers:new Map(o.fetchers),errors:{[k.route.id]:S.error}});return}F(!re(S),"Unhandled fetcher deferred data");let W={state:"idle",data:S.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(i,W),H({fetchers:new Map(o.fetchers)})}async function fe(i,l,c){var p;let{submission:g,replace:R,isFetchActionRedirect:M}=c===void 0?{}:c;l.revalidate&&(j=!0);let b=we(i.location,l.location,A({_isRedirect:!0},M?{_isFetchActionRedirect:!0}:{}));if(F(b,"Expected a location on the redirect navigation"),wt.test(l.location)&&Rt&&typeof((p=window)==null?void 0:p.location)<"u"){let B=e.history.createURL(l.location),K=Pe(B.pathname,s)==null;if(window.location.origin!==B.origin||K){R?window.location.replace(l.location):window.location.assign(l.location);return}}D=null;let v=R===!0?N.Replace:N.Push,{formMethod:x,formAction:S,formEncType:W,formData:k}=i.navigation;!g&&x&&S&&k&&W&&(g={formMethod:x,formAction:S,formEncType:W,formData:k}),mr.has(l.status)&&g&&q(g.formMethod)?await X(v,b,{submission:A({},g,{formAction:l.location}),preventScrollReset:L}):M?await X(v,b,{overrideNavigation:{state:"loading",location:b,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},fetcherSubmission:g,preventScrollReset:L}):await X(v,b,{overrideNavigation:{state:"loading",location:b,formMethod:g?g.formMethod:void 0,formAction:g?g.formAction:void 0,formEncType:g?g.formEncType:void 0,formData:g?g.formData:void 0},preventScrollReset:L})}async function Ye(i,l,c,p,g){let R=await Promise.all([...c.map(v=>me("loader",g,v,l,r,t,s)),...p.map(v=>v.matches&&v.match&&v.controller?me("loader",ge(e.history,v.path,v.controller.signal),v.match,v.matches,r,t,s):{type:O.error,error:G(404,{pathname:v.path})})]),M=R.slice(0,c.length),b=R.slice(c.length);return await Promise.all([ft(i,c,M,M.map(()=>g.signal),!1,o.loaderData),ft(i,p.map(v=>v.match),b,p.map(v=>v.controller?v.controller.signal:null),!0)]),{results:R,loaderResults:M,fetcherResults:b}}function Se(){j=!0,Y.push(...Ce()),ae.forEach((i,l)=>{_.has(l)&&(ee.push(l),oe(l))})}function Fe(i,l,c){let p=le(o.matches,l);Ue(i),H({errors:{[p.route.id]:c},fetchers:new Map(o.fetchers)})}function Ue(i){_.has(i)&&oe(i),ae.delete(i),de.delete(i),ce.delete(i),o.fetchers.delete(i)}function oe(i){let l=_.get(i);F(l,"Expected fetch controller: "+i),l.abort(),_.delete(i)}function Ge(i){for(let l of i){let p={state:"idle",data:Ve(l).data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(l,p)}}function qe(){let i=[],l=!1;for(let c of ce){let p=o.fetchers.get(c);F(p,"Expected fetcher: "+c),p.state==="loading"&&(ce.delete(c),i.push(c),l=!0)}return Ge(i),l}function Je(i){let l=[];for(let[c,p]of de)if(p<i){let g=o.fetchers.get(c);F(g,"Expected fetcher: "+c),g.state==="loading"&&(oe(c),de.delete(c),l.push(c))}return Ge(l),l.length>0}function _t(i,l){let c=o.blockers.get(i)||nt;return J.get(i)!==l&&J.set(i,l),c}function he(i){o.blockers.delete(i),J.delete(i)}function De(i,l){let c=o.blockers.get(i)||nt;F(c.state==="unblocked"&&l.state==="blocked"||c.state==="blocked"&&l.state==="blocked"||c.state==="blocked"&&l.state==="proceeding"||c.state==="blocked"&&l.state==="unblocked"||c.state==="proceeding"&&l.state==="unblocked","Invalid blocker state transition: "+c.state+" -> "+l.state),o.blockers.set(i,l),H({blockers:new Map(o.blockers)})}function Xe(i){let{currentLocation:l,nextLocation:c,historyAction:p}=i;if(J.size===0)return;J.size>1&&ne(!1,"A router only supports one blocker at a time");let g=Array.from(J.entries()),[R,M]=g[g.length-1],b=o.blockers.get(R);if(!(b&&b.state==="proceeding")&&M({currentLocation:l,nextLocation:c,historyAction:p}))return R}function Ce(i){let l=[];return te.forEach((c,p)=>{(!i||i(p))&&(c.cancel(),l.push(p),te.delete(p))}),l}function zt(i,l,c){if(m=i,y=l,h=c||(p=>p.key),!E&&o.navigation===Ne){E=!0;let p=Qe(o.location,o.matches);p!=null&&H({restoreScrollPosition:p})}return()=>{m=null,y=null,h=null}}function Ot(i,l){if(m&&h&&y){let c=l.map(g=>ht(g,o.loaderData)),p=h(i,c)||i.key;m[p]=y()}}function Qe(i,l){if(m&&h&&y){let c=l.map(R=>ht(R,o.loaderData)),p=h(i,c)||i.key,g=m[p];if(typeof g=="number")return g}return null}function kt(i){a=i}return w={get basename(){return s},get state(){return o},get routes(){return n},initialize:Pt,subscribe:Lt,enableScrollRestoration:zt,navigate:Ke,fetch:Ct,revalidate:St,createHref:i=>e.history.createHref(i),encodeLocation:i=>e.history.encodeLocation(i),getFetcher:Ve,deleteFetcher:Ue,dispose:At,getBlocker:_t,deleteBlocker:he,_internalFetchControllers:_,_internalActiveDeferreds:te,_internalSetRoutes:kt},w}function br(e){return e!=null&&"formData"in e}function je(e,t,r,n,a,s,d){let u,f;if(s!=null&&d!=="path"){u=[];for(let h of t)if(u.push(h),h.route.id===s){f=h;break}}else u=t,f=t[t.length-1];let m=ir(a||".",yt(u).map(h=>h.pathnameBase),Pe(e.pathname,r)||e.pathname,d==="path");return a==null&&(m.search=e.search,m.hash=e.hash),(a==null||a===""||a===".")&&f&&f.route.index&&!We(m.search)&&(m.search=m.search?m.search.replace(/^\?/,"?index&"):"?index"),n&&r!=="/"&&(m.pathname=m.pathname==="/"?r:ve([r,m.pathname])),Re(m)}function at(e,t,r,n){if(!n||!br(n))return{path:r};if(n.formMethod&&!Pr(n.formMethod))return{path:r,error:G(405,{method:n.formMethod})};let a;if(n.formData){let u=n.formMethod||"get";if(a={formMethod:e?u.toUpperCase():u.toLowerCase(),formAction:Et(r),formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:n.formData},q(a.formMethod))return{path:r,submission:a}}let s=Z(r),d=Mt(n.formData);return t&&s.search&&We(s.search)&&d.append("index",""),s.search="?"+d,{path:Re(s),submission:a}}function wr(e,t){let r=e;if(t){let n=e.findIndex(a=>a.route.id===t);n>=0&&(r=e.slice(0,n))}return r}function ot(e,t,r,n,a,s,d,u,f,m,h,y,E){let I=E?Object.values(E)[0]:y?Object.values(y)[0]:void 0,C=e.createURL(t.location),U=e.createURL(a),w=E?Object.keys(E)[0]:void 0,P=wr(r,w).filter((D,z)=>{if(D.route.lazy)return!0;if(D.route.loader==null)return!1;if(Rr(t.loaderData,t.matches[z],D)||d.some(ee=>ee===D.route.id))return!0;let j=t.matches[z],Y=D;return it(D,A({currentUrl:C,currentParams:j.params,nextUrl:U,nextParams:Y.params},n,{actionResult:I,defaultShouldRevalidate:s||C.pathname+C.search===U.pathname+U.search||C.search!==U.search||Dt(j,Y)}))}),L=[];return f.forEach((D,z)=>{if(!r.some(_=>_.route.id===D.routeId))return;let j=ye(m,D.path,h);if(!j){L.push({key:z,routeId:D.routeId,path:D.path,matches:null,match:null,controller:null});return}let Y=He(j,D.path);if(u.includes(z)){L.push({key:z,routeId:D.routeId,path:D.path,matches:j,match:Y,controller:new AbortController});return}it(Y,A({currentUrl:C,currentParams:t.matches[t.matches.length-1].params,nextUrl:U,nextParams:r[r.length-1].params},n,{actionResult:I,defaultShouldRevalidate:s}))&&L.push({key:z,routeId:D.routeId,path:D.path,matches:j,match:Y,controller:new AbortController})}),[P,L]}function Rr(e,t,r){let n=!t||r.route.id!==t.route.id,a=e[r.route.id]===void 0;return n||a}function Dt(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function it(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}async function lt(e,t,r){if(!e.lazy)return;let n=await e.lazy();if(!e.lazy)return;let a=r[e.id];F(a,"No route found in manifest");let s={};for(let d in n){let f=a[d]!==void 0&&d!=="hasErrorBoundary";ne(!f,'Route "'+a.id+'" has a static property "'+d+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+d+'" will be ignored.')),!f&&!Ht.has(d)&&(s[d]=n[d])}Object.assign(a,s),Object.assign(a,A({},t(a),{lazy:void 0}))}async function me(e,t,r,n,a,s,d,u,f,m){u===void 0&&(u=!1),f===void 0&&(f=!1);let h,y,E,I=w=>{let o,P=new Promise((L,D)=>o=D);return E=()=>o(),t.signal.addEventListener("abort",E),Promise.race([w({request:t,params:r.params,context:m}),P])};try{let w=r.route[e];if(r.route.lazy)if(w)y=(await Promise.all([I(w),lt(r.route,s,a)]))[0];else if(await lt(r.route,s,a),w=r.route[e],w)y=await I(w);else if(e==="action"){let o=new URL(t.url),P=o.pathname+o.search;throw G(405,{method:t.method,pathname:P,routeId:r.route.id})}else return{type:O.data,data:void 0};else if(w)y=await I(w);else{let o=new URL(t.url),P=o.pathname+o.search;throw G(404,{pathname:P})}F(y!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(w){h=O.error,y=w}finally{E&&t.signal.removeEventListener("abort",E)}if(xr(y)){let w=y.status;if(pr.has(w)){let L=y.headers.get("Location");if(F(L,"Redirects returned/thrown from loaders/actions must have a Location header"),!wt.test(L))L=je(new URL(t.url),n.slice(0,n.indexOf(r)+1),d,!0,L);else if(!u){let D=new URL(t.url),z=L.startsWith("//")?new URL(D.protocol+L):new URL(L),j=Pe(z.pathname,d)!=null;z.origin===D.origin&&j&&(L=z.pathname+z.search+z.hash)}if(u)throw y.headers.set("Location",L),y;return{type:O.redirect,status:w,location:L,revalidate:y.headers.get("X-Remix-Revalidate")!==null}}if(f)throw{type:h||O.data,response:y};let o,P=y.headers.get("Content-Type");return P&&/\bapplication\/json\b/.test(P)?o=await y.json():o=await y.text(),h===O.error?{type:h,error:new vt(w,y.statusText,o),headers:y.headers}:{type:O.data,data:o,statusCode:y.status,headers:y.headers}}if(h===O.error)return{type:h,error:y};if(Er(y)){var C,U;return{type:O.deferred,deferredData:y,statusCode:(C=y.init)==null?void 0:C.status,headers:((U=y.init)==null?void 0:U.headers)&&new Headers(y.init.headers)}}return{type:O.data,data:y}}function ge(e,t,r,n){let a=e.createURL(Et(t)).toString(),s={signal:r};if(n&&q(n.formMethod)){let{formMethod:d,formEncType:u,formData:f}=n;s.method=d.toUpperCase(),s.body=u==="application/x-www-form-urlencoded"?Mt(f):f}return new Request(a,s)}function Mt(e){let t=new URLSearchParams;for(let[r,n]of e.entries())t.append(r,n instanceof File?n.name:n);return t}function Dr(e,t,r,n,a){let s={},d=null,u,f=!1,m={};return r.forEach((h,y)=>{let E=t[y].route.id;if(F(!se(h),"Cannot handle redirect results in processLoaderData"),be(h)){let I=le(e,E),C=h.error;n&&(C=Object.values(n)[0],n=void 0),d=d||{},d[I.route.id]==null&&(d[I.route.id]=C),s[E]=void 0,f||(f=!0,u=cr(h.error)?h.error.status:500),h.headers&&(m[E]=h.headers)}else re(h)?(a.set(E,h.deferredData),s[E]=h.deferredData.data):s[E]=h.data,h.statusCode!=null&&h.statusCode!==200&&!f&&(u=h.statusCode),h.headers&&(m[E]=h.headers)}),n&&(d=n,s[Object.keys(n)[0]]=void 0),{loaderData:s,errors:d,statusCode:u||200,loaderHeaders:m}}function st(e,t,r,n,a,s,d,u){let{loaderData:f,errors:m}=Dr(t,r,n,a,u);for(let h=0;h<s.length;h++){let{key:y,match:E,controller:I}=s[h];F(d!==void 0&&d[h]!==void 0,"Did not find corresponding fetcher result");let C=d[h];if(!(I&&I.signal.aborted))if(be(C)){let U=le(e.matches,E==null?void 0:E.route.id);m&&m[U.route.id]||(m=A({},m,{[U.route.id]:C.error})),e.fetchers.delete(y)}else if(se(C))F(!1,"Unhandled fetcher revalidation redirect");else if(re(C))F(!1,"Unhandled fetcher deferred data");else{let U={state:"idle",data:C.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};e.fetchers.set(y,U)}}return{loaderData:f,errors:m}}function dt(e,t,r,n){let a=A({},t);for(let s of r){let d=s.route.id;if(t.hasOwnProperty(d)?t[d]!==void 0&&(a[d]=t[d]):e[d]!==void 0&&s.route.loader&&(a[d]=e[d]),n&&n.hasOwnProperty(d))break}return a}function le(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function ct(e){let t=e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function G(e,t){let{pathname:r,routeId:n,method:a,type:s}=t===void 0?{}:t,d="Unknown Server Error",u="Unknown @remix-run/router error";return e===400?(d="Bad Request",a&&r&&n?u="You made a "+a+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":s==="defer-action"&&(u="defer() is not supported in actions")):e===403?(d="Forbidden",u='Route "'+n+'" does not match URL "'+r+'"'):e===404?(d="Not Found",u='No route matches URL "'+r+'"'):e===405&&(d="Method Not Allowed",a&&r&&n?u="You made a "+a.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":a&&(u='Invalid request method "'+a.toUpperCase()+'"')),new vt(e||500,d,new Error(u),!0)}function ut(e){for(let t=e.length-1;t>=0;t--){let r=e[t];if(se(r))return r}}function Et(e){let t=typeof e=="string"?Z(e):e;return Re(A({},t,{hash:""}))}function Mr(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function re(e){return e.type===O.deferred}function be(e){return e.type===O.error}function se(e){return(e&&e.type)===O.redirect}function Er(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function xr(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function Pr(e){return hr.has(e.toLowerCase())}function q(e){return ur.has(e.toLowerCase())}async function ft(e,t,r,n,a,s){for(let d=0;d<r.length;d++){let u=r[d],f=t[d];if(!f)continue;let m=e.find(y=>y.route.id===f.route.id),h=m!=null&&!Dt(m,f)&&(s&&s[f.route.id])!==void 0;if(re(u)&&(a||h)){let y=n[d];F(y,"Expected an AbortSignal for revalidating fetcher deferred result"),await xt(u,y,a).then(E=>{E&&(r[d]=E||r[d])})}}}async function xt(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:O.data,data:e.deferredData.unwrappedData}}catch(a){return{type:O.error,error:a}}return{type:O.data,data:e.deferredData.data}}}function We(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function ht(e,t){let{route:r,pathname:n,params:a}=e;return{id:r.id,pathname:n,params:a,data:t[r.id],handle:r.handle}}function He(e,t){let r=typeof t=="string"?Z(t).search:t.search;if(e[e.length-1].route.index&&We(r||""))return e[e.length-1];let n=yt(e);return n[n.length-1]}export{N as A,vt as E,cr as a,Ar as b,Lr as c,Re as d,yt as g,F as i,ve as j,ye as m,Z as p,ir as r,Pe as s};
